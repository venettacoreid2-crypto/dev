<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vencorio HQ - Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>
    
</head>
<body>
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <nav id="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-shield-alt"></i> Vencorio HQ</h3>
            <button class="close-sidebar" id="closeSidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="user-profile">
            <img id="profileImage" src="https://ui-avatars.com/api/?name=Admin+User&background=3498db&color=fff&size=128" alt="Profile">
            <h5 id="userName">Admin User</h5>
            <p id="userRole">Administrator</p>
            <p id="userCompany">Vencorio Inc.</p>
            <button class="btn btn-outline-light profile-btn" id="myProfileBtn">
                <i class="fas fa-user-circle"></i> My Profile
            </button>
        </div>

        <div class="sidebar-menu">
            <ul>
                <!-- Dashboard -->
                <li><a href="#" class="active" data-page="dashboard" data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>

                <!-- InterComm -->
                <li><a href="#" data-page="intercomm" data-tab="intercomm"><i class="fas fa-comments"></i> InterComm</a></li>

                <!-- Workflow -->
                <li><a href="#" data-page="workflow" data-tab="workflow"><i class="fas fa-project-diagram"></i> Workflow</a></li>

                <!-- My Desk -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="mydesk">
                        <i class="fas fa-desktop"></i> My Desk
                    </a>
                </li>
                <ul class="submenu" id="mydeskSubmenu">
                    <li><a href="#" data-page="mydesk-onprogress" data-tab="mydesk-onprogress">On progress</a></li>
                    <li><a href="#" data-page="mydesk-tasklist" data-tab="mydesk-tasklist">Task List</a></li>
                    <li><a href="#" data-page="mydesk-reporting" data-tab="mydesk-reporting">Reporting</a></li>
                </ul>

                <!-- Control Center -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="controlcenter">
                        <i class="fas fa-cogs"></i> Control Center
                    </a>
                </li>
                <ul class="submenu" id="controlcenterSubmenu">
                    <li><a href="#" data-page="controlcenter-overview" data-tab="controlcenter-overview">Overview</a></li>
                    <li><a href="#" data-page="controlcenter-lettering" data-tab="controlcenter-lettering">Lettering</a></li>
                    <li><a href="#" data-page="controlcenter-reporting" data-tab="controlcenter-reporting">Reporting</a></li>
                    <li><a href="#" data-page="controlcenter-roadmap" data-tab="controlcenter-roadmap">Roadmap</a></li>
                    <li><a href="#" data-page="controlcenter-taskingcenter" data-tab="controlcenter-taskingcenter">Tasking Center</a></li>
                </ul>

                <!-- Operational -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="operational">
                        <i class="fas fa-industry"></i> Operational
                    </a>
                </li>
                <ul class="submenu" id="operationalSubmenu">
                    <li><a href="#" data-page="operational-controlroom" data-tab="operational-controlroom">Control Room</a></li>
                    <li><a href="#" data-page="operational-engineering" data-tab="operational-engineering">Engineering</a></li>
                    <li><a href="#" data-page="operational-reporting" data-tab="operational-reporting">Reporting</a></li>
                    <li><a href="#" data-page="operational-tasklist" data-tab="operational-tasklist">Task List</a></li>
                </ul>

                <!-- Finance -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="finance">
                        <i class="fas fa-money-bill-wave"></i> Finance
                    </a>
                </li>
                <ul class="submenu" id="financeSubmenu">
                    <li><a href="#" data-page="finance-overview" data-tab="finance-overview">Overview</a></li>
                    <li><a href="#" data-page="finance-financials" data-tab="finance-financials">Financials</a></li>
                    <li><a href="#" data-page="finance-tax" data-tab="finance-tax">Tax Compliances</a></li>
                    <li><a href="#" data-page="finance-reporting" data-tab="finance-reporting">Reporting</a></li>
                    <li><a href="#" data-page="finance-tasklist" data-tab="finance-tasklist">Task List</a></li>
                </ul>

                <!-- Support -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="support">
                        <i class="fas fa-headset"></i> Support
                    </a>
                </li>
                <ul class="submenu" id="supportSubmenu">
                    <li><a href="#" data-page="support-newsletter" data-tab="support-newsletter">NewsLetter</a></li>
                    <li><a href="#" data-page="support-social" data-tab="support-social">Social Media</a></li>
                    <li><a href="#" data-page="support-logistic" data-tab="support-logistic">Logistic</a></li>
                    <li><a href="#" data-page="support-tasklist" data-tab="support-tasklist">Task List</a></li>
                </ul>

                <!-- CRM -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="crm">
                        <i class="fas fa-address-book"></i> CRM
                    </a>
                </li>
                <ul class="submenu" id="crmSubmenu">
                    <li><a href="#" data-page="crm-newsletter" data-tab="crm-newsletter">Newsletter</a></li>
                    <li><a href="#" data-page="crm-social" data-tab="crm-social">Social Media</a></li>
                    <li><a href="#" data-page="crm-shareholder-update" data-tab="crm-shareholder-update">Shareholder Update</a></li>
                    <li><a href="#" data-page="crm-shareholder-report" data-tab="crm-shareholder-report">Shareholder Report</a></li>
                    <li><a href="#" data-page="crm-supplier" data-tab="crm-supplier">Supplier</a></li>
                    <li><a href="#" data-page="crm-vendor" data-tab="crm-vendor">Vendor</a></li>
                    <li><a href="#" data-page="crm-outsourcing" data-tab="crm-outsourcing">Outsourcing</a></li>
                    <li><a href="#" data-page="crm-tasklist" data-tab="crm-tasklist">Task List</a></li>
                </ul>

                <!-- R & D -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="rnd">
                        <i class="fas fa-flask"></i> R & D
                    </a>
                </li>
                <ul class="submenu" id="rndSubmenu">
                    <li><a href="#" data-page="rnd-addresearch" data-tab="rnd-addresearch">Add Research</a></li>
                    <li><a href="#" data-page="rnd-researchlist" data-tab="rnd-researchlist">Research List</a></li>
                    <li><a href="#" data-page="rnd-researchreport" data-tab="rnd-researchreport">Research Report</a></li>
                    <li><a href="#" data-page="rnd-myresearch" data-tab="rnd-myresearch">My Research</a></li>
                </ul>

                <!-- Shareholders -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="shareholders">
                        <i class="fas fa-users"></i> Shareholders
                    </a>
                </li>
                <ul class="submenu" id="shareholdersSubmenu">
                    <li><a href="#" data-page="shareholders-overview" data-tab="shareholders-overview">Overview</a></li>
                    <li><a href="#" data-page="shareholders-reports" data-tab="shareholders-reports">Reports</a></li>
                    <li><a href="#" data-page="shareholders-dataroom" data-tab="shareholders-dataroom">Data Room</a></li>
                    <li><a href="#" data-page="shareholders-announcements" data-tab="shareholders-announcements">Announcements</a></li>
                </ul>

                <!-- Investors -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="investors">
                        <i class="fas fa-chart-line"></i> Investors
                    </a>
                </li>
                <ul class="submenu" id="investorsSubmenu">
                    <li><a href="#" data-page="investors-overview" data-tab="investors-overview">Overview</a></li>
                    <li><a href="#" data-page="investors-dataroom" data-tab="investors-dataroom">Data Room (Due Diligence)</a></li>
                    <li><a href="#" data-page="investors-pitch" data-tab="investors-pitch">Pitch Material</a></li>
                    <li><a href="#" data-page="investors-termsheet" data-tab="investors-termsheet">Term Sheet</a></li>
                    <li><a href="#" data-page="investors-survey" data-tab="investors-survey">Survey & Feedback</a></li>
                </ul>

                <!-- Data Room -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="dataroom">
                        <i class="fas fa-folder-open"></i> Data Room
                    </a>
                </li>
                <ul class="submenu" id="dataroomSubmenu">
                    <li><a href="#" data-page="dataroom-main" data-tab="dataroom-main">Dataroom</a></li>
                    <li><a href="#" data-page="dataroom-archives" data-tab="dataroom-archives">Archives</a></li>
                    <li><a href="#" data-page="dataroom-library" data-tab="dataroom-library">Library</a></li>
                </ul>

                <!-- Legal & Advisor -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="legaladvisor">
                        <i class="fas fa-balance-scale"></i> Legal & Advisor
                    </a>
                </li>
                <ul class="submenu" id="legaladvisorSubmenu">
                    <li><a href="#" data-page="legaladvisor-legal" data-tab="legaladvisor-legal">Legal</a></li>
                    <li><a href="#" data-page="legaladvisor-advisor" data-tab="legaladvisor-advisor">Advisor</a></li>
                    <li><a href="#" data-page="legaladvisor-reportlist" data-tab="legaladvisor-reportlist">Report List</a></li>
                    <li><a href="#" data-page="legaladvisor-dataroom" data-tab="legaladvisor-dataroom">Data Room</a></li>
                </ul>

                <!-- Administrator -->
                <li class="menu-item-with-arrow">
                    <a href="#" data-menu="administrator">
                        <i class="fas fa-user-shield"></i> Administrator
                    </a>
                </li>
                <ul class="submenu" id="administratorSubmenu">
                    <li><a href="#" data-page="administrator-usermanagement" data-tab="administrator-usermanagement">User Management</a></li>
                    <li><a href="#" data-page="administrator-server" data-tab="administrator-server">Server Management</a></li>
                    <li><a href="#" data-page="administrator-application" data-tab="administrator-application">Application Management</a></li>
                    <li><a href="#" data-page="administrator-system" data-tab="administrator-system">System Management</a></li>
                </ul>

                <!-- Quick View -->
                <li><a href="#" data-page="quickview" data-tab="quickview"><i class="fas fa-chart-bar"></i> Quick View</a></li>

                <!-- SYSTEM STATUS (PERBAIKAN 1: Menu terpisah) -->
                <li><a href="#" data-page="systemstatus" data-tab="systemstatus"><i class="fas fa-server"></i> System Status</a></li>

                <!-- Help -->
                <li><a href="#" data-page="help" data-tab="help"><i class="fas fa-question-circle"></i> Help</a></li>

                <!-- My Drive -->
                <li><a href="#" data-page="mydrive" data-tab="mydrive"><i class="fas fa-hdd"></i> My Drive</a></li>

                <!-- Shared Drive -->
                <li><a href="#" data-page="shareddrive" data-tab="shareddrive"><i class="fas fa-users"></i> Shared Drive</a></li>

                <!-- My Calendar -->
                <li><a href="#" data-page="mycalendar" data-tab="mycalendar"><i class="fas fa-calendar-alt"></i> My Calendar</a></li>
            </ul>
        </div>

        <!-- PERBAIKAN: Sidebar footer dengan logout -->
        <div class="sidebar-footer">
            <button id="logoutBtn" class="btn btn-sm btn-outline-light w-100">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div id="main-content">
        <!-- Header -->
        <div class="main-header">
            <div class="d-flex align-items-center">
                <button class="sidebar-toggle me-3" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="page-title">
                    <h1 id="pageTitle">Admin Dashboard</h1>
                    <p id="pageSubtitle">Welcome back, <span id="greetingName">Admin</span>. Here's what's happening today.</p>
                </div>
            </div>

            <div class="header-actions">
                <button class="btn btn-info" id="refreshDataBtn" title="Refresh Data">
                    <i class="fas fa-sync-alt"></i>
                </button>

                <div class="notification-dropdown" id="notificationDropdown">
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationCount">5</span>
                    </button>
                    <div class="notification-dropdown-content">
                        <div class="notification-header">
                            <h5>Notifications</h5>
                            <button class="btn btn-sm btn-link" id="markAllRead">Mark all as read</button>
                        </div>
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be loaded here -->
                        </div>
                        <div class="notification-footer text-center p-2">
                            <a href="#" class="text-primary" id="viewAllNotifications">View all notifications</a>
                        </div>
                    </div>
                </div>

                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle" type="button" id="quickActions" data-bs-toggle="dropdown">
                        <i class="fas fa-bolt"></i> Quick Actions
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" data-action="new-task"><i class="fas fa-plus-circle"></i> New Task</a></li>
                        <li><a class="dropdown-item" href="#" data-action="new-announcement"><i class="fas fa-bullhorn"></i> New Announcement</a></li>
                        <li><a class="dropdown-item" href="#" data-action="upload-file"><i class="fas fa-upload"></i> Upload File</a></li>
                        <li><a class="dropdown-item" href="#" data-action="schedule-meeting"><i class="fas fa-calendar-plus"></i> Schedule Meeting</a></li>
                    </ul>
                </div>

                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="themeDropdown" data-bs-toggle="dropdown">
                        <i class="fas fa-palette"></i> Theme
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" data-theme="light">Light Mode</a></li>
                        <li><a class="dropdown-item" href="#" data-theme="dark">Dark Mode</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Multi-tab Navigation -->
        <div class="tabs-wrapper">
            <ul class="nav nav-tabs" id="mainTabs">
                <li class="nav-item tab-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#tab-dashboard">
                        <i class="fas fa-tachometer-alt me-1"></i> Dashboard
                        <button class="close-tab" onclick="closeTab('dashboard', event)" style="display: none;">&times;</button>
                    </a>
                </li>
                <!-- Dynamic tabs will be added here -->
            </ul>
            <div class="tab-content">
                <!-- Dashboard Tab -->
                <div class="tab-pane fade show active" id="tab-dashboard">
                    <!-- Dashboard content will be loaded here -->
                </div>
                <!-- Dynamic tab panes will be added here -->
            </div>
        </div>

        <!-- Tab Manager -->
        <div class="tab-manager">
            <button class="tab-manager-btn" id="tabManagerBtn">
                <i class="fas fa-layer-group"></i>
            </button>
            <div class="tab-manager-dropdown">
                <div class="tab-manager-item" id="closeAllTabs">
                    <i class="fas fa-times-circle me-2"></i> Close All Tabs
                </div>
                <div class="tab-manager-item" id="closeOtherTabs">
                    <i class="fas fa-window-close me-2"></i> Close Other Tabs
                </div>
                <div class="tab-manager-item" id="reloadTab">
                    <i class="fas fa-redo me-2"></i> Reload Current Tab
                </div>
                <div class="tab-manager-item" id="pinTab">
                    <i class="fas fa-thumbtack me-2"></i> Pin Current Tab
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>&copy; 2023 Vencorio HQ. All rights reserved. | Employee ID: <span id="employeeId">26190101</span> | IP: <span id="ipAddress">192.168.1.100</span> | Location: <span id="location">Jakarta, Indonesia</span></p>
            <p class="text-muted mt-2"><small><i class="fas fa-info-circle"></i> Multi-tab interface active. Open multiple submenus as tabs.</small></p>
        </div>
    </div>

    <!-- Modals -->
    <!-- Profile Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-edit"></i> Edit Profile</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-4 text-center mb-4">
                                <div class="profile-image-container">
                                    <img id="modalProfileImage" src="https://ui-avatars.com/api/?name=Admin+User&background=3498db&color=fff&size=256" alt="Profile" class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                                    <div class="mt-2">
                                        <button type="button" class="btn btn-sm btn-primary" id="changePhotoBtn">
                                            <i class="fas fa-camera"></i> Change Photo
                                        </button>
                                        <input type="file" id="photoUpload" accept="image/*" style="display: none;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="username" class="form-label">Username</label>
                                        <input type="text" class="form-control" id="username" value="admin" readonly>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="email" class="form-label">Email</label>
                                        <input type="email" class="form-control" id="email" value="admin@vencorio.com">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="employeeIdInput" class="form-label">Employee ID</label>
                                        <input type="text" class="form-control" id="employeeIdInput" value="26190101" readonly>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="waNumber" class="form-label">WhatsApp Number</label>
                                        <input type="text" class="form-control" id="waNumber" value="+62-81234567890">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="department" class="form-label">Department</label>
                                        <input type="text" class="form-control" id="department" value="Administration">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="division" class="form-label">Division</label>
                                        <input type="text" class="form-control" id="division" value="IT Department">
                                    </div>
                                    <div class="col-md-12 mb-3">
                                        <label for="company" class="form-label">Company</label>
                                        <input type="text" class="form-control" id="company" value="Vencorio Inc.">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveProfileBtn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-sliders-h"></i> User Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="settingsForm">
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
                                <label class="form-check-label" for="emailNotifications">Email Notifications</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="pushNotifications" checked>
                                <label class="form-check-label" for="pushNotifications">Push Notifications</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="autoSync">
                                <label class="form-check-label" for="autoSync">Auto Sync Data</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="themeSelect" class="form-label">Theme</label>
                                <select class="form-control" id="themeSelect">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="auto">Auto (System)</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="languageSelect" class="form-label">Language</label>
                                <select class="form-control" id="languageSelect">
                                    <option value="en" selected>English</option>
                                    <option value="id">Indonesian</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="timezoneSelect" class="form-label">Timezone</label>
                            <select class="form-control" id="timezoneSelect">
                                <option value="Asia/Jakarta" selected>Asia/Jakarta (WIB)</option>
                                <option value="UTC">UTC</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveSettingsBtn">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal fade" id="taskModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-plus-circle"></i> Create New Task</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Task form content -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary">Create Task</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay">
        <div class="text-center text-white">
            <div class="spinner-border" style="width: 3rem; height: 3rem;"></div>
            <h4 class="mt-3">Loading Tab Content...</h4>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global Variables
        let currentUser = null;
        let notifications = [];
        let tasks = [];
        let users = [];
        let activeTabs = [];
        let charts = {};

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initSidebar();
            initEventListeners();
            loadUserData();
            updateIPLocation();
            setGreeting();

            // Set theme from localStorage
            const savedTheme = localStorage.getItem('vencorio_theme') || 'light';
            setTheme(savedTheme);

            // Load dashboard as first tab
            loadDashboardContent();

            // Show welcome message
            setTimeout(() => {
                showToast('Multi-tab interface ready! Click submenus to open in tabs.', 'info');
            }, 1000);
        });

        // Initialize sidebar with submenu functionality
        function initSidebar() {
            // Sidebar toggle for mobile
            document.getElementById('sidebarToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
                document.getElementById('sidebarOverlay').classList.toggle('active');
            });

            // Close sidebar button
            document.getElementById('closeSidebar').addEventListener('click', function() {
                document.getElementById('sidebar').classList.remove('active');
                document.getElementById('sidebarOverlay').classList.remove('active');
            });

            // Close sidebar when clicking on overlay
            document.getElementById('sidebarOverlay').addEventListener('click', function() {
                document.getElementById('sidebar').classList.remove('active');
                this.classList.remove('active');
            });

            // My Profile button
            document.getElementById('myProfileBtn').addEventListener('click', function() {
                loadProfileTab();
            });

            // Main menu items (with submenus)
            document.querySelectorAll('.menu-item-with-arrow').forEach(item => {
                const link = item.querySelector('a');
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();

                    const menuName = this.getAttribute('data-menu');
                    const submenu = document.getElementById(menuName + 'Submenu');

                    // Toggle submenu
                    if (submenu) {
                        submenu.classList.toggle('active');
                        item.classList.toggle('active');
                    }

                    // Close other submenus
                    document.querySelectorAll('.submenu').forEach(sm => {
                        if (sm !== submenu) {
                            sm.classList.remove('active');
                        }
                    });

                    document.querySelectorAll('.menu-item-with-arrow').forEach(mi => {
                        if (mi !== item) {
                            mi.classList.remove('active');
                        }
                    });
                });
            });

            // Menu items (without submenus) - except dashboard
            document.querySelectorAll('.sidebar-menu > ul > li > a:not([data-menu]):not([data-page="dashboard"])').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();

                    const page = this.getAttribute('data-page');
                    const tab = this.getAttribute('data-tab');
                    const text = this.textContent;

                    // Open in new tab
                    loadTab(page, text, this.querySelector('i').className);

                    // Update active state in sidebar
                    document.querySelectorAll('.sidebar-menu a').forEach(link => {
                        link.classList.remove('active');
                    });
                    this.classList.add('active');

                    // Close sidebar on mobile
                    if (window.innerWidth < 992) {
                        document.getElementById('sidebar').classList.remove('active');
                        document.getElementById('sidebarOverlay').classList.remove('active');
                    }
                });
            });

            // Dashboard menu item
            document.querySelector('[data-page="dashboard"]').addEventListener('click', function(e) {
                e.preventDefault();

                // Switch to dashboard (no new tab)
                switchToDashboard();

                // Update active state
                document.querySelectorAll('.sidebar-menu a').forEach(link => {
                    link.classList.remove('active');
                });
                this.classList.add('active');

                // Close sidebar on mobile
                if (window.innerWidth < 992) {
                    document.getElementById('sidebar').classList.remove('active');
                    document.getElementById('sidebarOverlay').classList.remove('active');
                }
            });

            // Submenu items
            document.querySelectorAll('.submenu a').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();

                    const page = this.getAttribute('data-page');
                    const tab = this.getAttribute('data-tab');
                    const text = this.textContent;

                    // Open in new tab
                    loadTab(page, text, getIconForPage(page));

                    // Update active state in sidebar
                    document.querySelectorAll('.sidebar-menu a').forEach(link => {
                        link.classList.remove('active');
                    });

                    // Highlight parent menu
                    const parentMenu = this.closest('.submenu').previousElementSibling;
                    if (parentMenu) {
                        parentMenu.querySelector('a').classList.add('active');
                    }

                    // Close sidebar on mobile
                    if (window.innerWidth < 992) {
                        document.getElementById('sidebar').classList.remove('active');
                        document.getElementById('sidebarOverlay').classList.remove('active');
                    }
                });
            });
        }

        // Load dashboard content (not as tab)
        function loadDashboardContent() {
            const dashboardPane = document.getElementById('tab-dashboard');
            if (dashboardPane) {
                dashboardPane.innerHTML = getDashboardContent();

                // Initialize dashboard charts
                setTimeout(() => {
                    initDashboardCharts();
                }, 100);
            }
        }

        // Switch to dashboard
        function switchToDashboard() {
            // Remove active class from all tabs
            document.querySelectorAll('#mainTabs .nav-link').forEach(tab => {
                tab.classList.remove('active');
            });

            // Add active class to dashboard tab
            const dashboardTab = document.querySelector('#mainTabs [href="#tab-dashboard"]');
            if (dashboardTab) {
                dashboardTab.classList.add('active');
            }

            // Remove active class from all tab panes
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('show', 'active');
            });

            // Add active class to dashboard pane
            const dashboardPane = document.getElementById('tab-dashboard');
            if (dashboardPane) {
                dashboardPane.classList.add('show', 'active');
            }

            // Update page title
            document.getElementById('pageTitle').textContent = 'Admin Dashboard';
            document.getElementById('pageSubtitle').innerHTML = 'Welcome back, <span id="greetingName">Admin</span>. Here\'s what\'s happening today.';
        }

        // Get dashboard content with system status
        function getDashboardContent() {
            return `
                <div class="row">
                    <!-- System Status -->
                    <div class="col-lg-3 col-md-6">
                        <div class="card stats-card">
                            <div class="card-body">
                                <i class="fas fa-server text-primary"></i>
                                <h3 id="systemStatus">Healthy</h3>
                                <p>System Status</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Tasks -->
                    <div class="col-lg-3 col-md-6">
                        <div class="card stats-card">
                            <div class="card-body">
                                <i class="fas fa-tasks text-success"></i>
                                <h3 id="activeTasks">12</h3>
                                <p>Active Tasks</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Online Users -->
                    <div class="col-lg-3 col-md-6">
                        <div class="card stats-card">
                            <div class="card-body">
                                <i class="fas fa-users text-warning"></i>
                                <h3 id="onlineUsers">48</h3>
                                <p>Online Users</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Uptime -->
                    <div class="col-lg-3 col-md-6">
                        <div class="card stats-card">
                            <div class="card-body">
                                <i class="fas fa-chart-line text-info"></i>
                                <h3 id="uptimePercent">99.9%</h3>
                                <p>System Uptime</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <!-- Workflow Status -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-project-diagram"></i> Workflow Status</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="workflowChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Announcements -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-bullhorn"></i> Recent Announcements</h5>
                            </div>
                            <div class="card-body">
                                <div id="announcementsList">
                                    <div class="mb-3 pb-3 border-bottom">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <h6 class="mb-1">Q4 Company Strategy Meeting</h6>
                                                <p class="text-muted mb-1">All department heads required to attend on October 20, 2023 at 10:00 AM in the main conference room.</p>
                                                <small class="text-muted">By Admin User • 1 day ago</small>
                                            </div>
                                            <span class="badge text-danger">HIGH</span>
                                        </div>
                                    </div>
                                    <div class="mb-3 pb-3 border-bottom">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <h6 class="mb-1">System Maintenance Notice</h6>
                                                <p class="text-muted mb-1">System will be offline Sunday 2AM-4AM for scheduled maintenance. Please save all work before this time.</p>
                                                <small class="text-muted">By System Admin • 2 days ago</small>
                                            </div>
                                            <span class="badge text-warning">MEDIUM</span>
                                        </div>
                                    </div>
                                    <div class="mb-3 pb-3 border-bottom">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <h6 class="mb-1">New HR Policy Update</h6>
                                                <p class="text-muted mb-1">Please review the updated remote work policy effective November 1, 2023. All employees must acknowledge receipt.</p>
                                                <small class="text-muted">By HR Manager • 3 days ago</small>
                                            </div>
                                            <span class="badge text-success">LOW</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <!-- Growth Chart -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-bar"></i> Growth Aggregate</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="growthChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Exchange Rates -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-exchange-alt"></i> Exchange Rates</h5>
                            </div>
                            <div class="card-body">
                                <ul class="nav nav-tabs" id="exchangeTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="fiat-tab" data-bs-toggle="tab" data-bs-target="#fiat" type="button">Fiat</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="crypto-tab" data-bs-toggle="tab" data-bs-target="#crypto" type="button">Crypto</button>
                                    </li>
                                </ul>
                                <div class="tab-content mt-3" id="exchangeTabContent">
                                    <div class="tab-pane fade show active" id="fiat" role="tabpanel">
                                        <div class="chart-container">
                                            <canvas id="fiatChart"></canvas>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="crypto" role="tabpanel">
                                        <div class="chart-container">
                                            <canvas id="cryptoChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <!-- Recent Tasks -->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5><i class="fas fa-tasks"></i> Recent Tasks</h5>
                                <button class="btn btn-sm btn-primary" onclick="openTaskModal()">
                                    <i class="fas fa-plus"></i> New Task
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Title</th>
                                                <th>Assignee</th>
                                                <th>Deadline</th>
                                                <th>Priority</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="recentTasksTable">
                                            <tr>
                                                <td>Q3 Financial Report</td>
                                                <td>John Doe</td>
                                                <td>Oct 20, 2023</td>
                                                <td><span class="badge bg-danger">High</span></td>
                                                <td><span class="badge badge-status badge-in-progress">In Progress</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="editTask(1)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Website Redesign</td>
                                                <td>Jane Smith</td>
                                                <td>Oct 25, 2023</td>
                                                <td><span class="badge bg-warning">Medium</span></td>
                                                <td><span class="badge badge-status badge-pending">Pending</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="editTask(2)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Server Migration</td>
                                                <td>Robert Johnson</td>
                                                <td>Oct 18, 2023</td>
                                                <td><span class="badge bg-dark">Critical</span></td>
                                                <td><span class="badge badge-status badge-in-progress">In Progress</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="editTask(3)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Marketing Campaign</td>
                                                <td>Sarah Williams</td>
                                                <td>Oct 30, 2023</td>
                                                <td><span class="badge bg-warning">Medium</span></td>
                                                <td><span class="badge badge-status badge-review">Review</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="editTask(4)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Employee Training</td>
                                                <td>Michael Brown</td>
                                                <td>Oct 22, 2023</td>
                                                <td><span class="badge bg-success">Low</span></td>
                                                <td><span class="badge badge-status badge-completed">Completed</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary" onclick="editTask(5)">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Status Section -->
                <div class="row mt-4 dashboard-system-status">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-cogs"></i> System Status</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="system-status-card">
                                            <h4 class="text-white mb-4"><i class="fas fa-server"></i> System Health Dashboard</h4>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Overall System Status</strong>
                                                </div>
                                                <span class="badge bg-success">Healthy</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Web Server</strong>
                                                </div>
                                                <span class="badge bg-success">Running</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Database</strong>
                                                </div>
                                                <span class="badge bg-success">Optimal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-warning"></span>
                                                    <strong>Email Service</strong>
                                                </div>
                                                <span class="badge bg-warning">Degraded</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>File Storage</strong>
                                                </div>
                                                <span class="badge bg-success">Normal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>API Gateway</strong>
                                                </div>
                                                <span class="badge bg-success">Stable</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6><i class="fas fa-chart-pie"></i> Resource Usage</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>CPU Usage</span>
                                                        <span>42%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-info" style="width: 42%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Memory Usage</span>
                                                        <span>68%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-warning" style="width: 68%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Storage Usage</span>
                                                        <span>54%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-success" style="width: 54%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Network Load</span>
                                                        <span>32%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-primary" style="width: 32%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load profile tab with 4 subtabs
        function loadProfileTab() {
            loadTab('profile', 'My Profile', 'fas fa-user-circle');
        }

        // Get icon for page
        function getIconForPage(page) {
            const icons = {
                // My Desk
                'mydesk-onprogress': 'fas fa-spinner',
                'mydesk-tasklist': 'fas fa-tasks',
                'mydesk-reporting': 'fas fa-chart-bar',

                // Control Center
                'controlcenter-overview': 'fas fa-eye',
                'controlcenter-lettering': 'fas fa-envelope',
                'controlcenter-reporting': 'fas fa-file-alt',
                'controlcenter-roadmap': 'fas fa-road',
                'controlcenter-taskingcenter': 'fas fa-tasks',

                // Operational
                'operational-controlroom': 'fas fa-tv',
                'operational-engineering': 'fas fa-cogs',
                'operational-reporting': 'fas fa-chart-line',
                'operational-tasklist': 'fas fa-list-check',

                // Finance
                'finance-overview': 'fas fa-chart-pie',
                'finance-financials': 'fas fa-money-bill-wave',
                'finance-tax': 'fas fa-file-invoice-dollar',
                'finance-reporting': 'fas fa-file-alt',
                'finance-tasklist': 'fas fa-tasks',

                // Support
                'support-newsletter': 'fas fa-newspaper',
                'support-social': 'fas fa-hashtag',
                'support-logistic': 'fas fa-truck',
                'support-tasklist': 'fas fa-tasks',

                // CRM
                'crm-newsletter': 'fas fa-envelope',
                'crm-social': 'fas fa-share-alt',
                'crm-shareholder-update': 'fas fa-users',
                'crm-shareholder-report': 'fas fa-file-contract',
                'crm-supplier': 'fas fa-industry',
                'crm-vendor': 'fas fa-store',
                'crm-outsourcing': 'fas fa-handshake',
                'crm-tasklist': 'fas fa-tasks',

                // R & D
                'rnd-addresearch': 'fas fa-plus-circle',
                'rnd-researchlist': 'fas fa-list',
                'rnd-researchreport': 'fas fa-file-alt',
                'rnd-myresearch': 'fas fa-user-graduate',

                // Shareholders
                'shareholders-overview': 'fas fa-eye',
                'shareholders-reports': 'fas fa-file-alt',
                'shareholders-dataroom': 'fas fa-folder-open',
                'shareholders-announcements': 'fas fa-bullhorn',

                // Investors
                'investors-overview': 'fas fa-eye',
                'investors-dataroom': 'fas fa-folder-open',
                'investors-pitch': 'fas fa-presentation',
                'investors-termsheet': 'fas fa-file-contract',
                'investors-survey': 'fas fa-poll',

                // Data Room
                'dataroom-main': 'fas fa-folder-open',
                'dataroom-archives': 'fas fa-archive',
                'dataroom-library': 'fas fa-book',

                // Legal & Advisor
                'legaladvisor-legal': 'fas fa-balance-scale',
                'legaladvisor-advisor': 'fas fa-user-tie',
                'legaladvisor-reportlist': 'fas fa-list-alt',
                'legaladvisor-dataroom': 'fas fa-folder-open',

                // Administrator
                'administrator-usermanagement': 'fas fa-users-cog',
                'administrator-server': 'fas fa-server',
                'administrator-application': 'fas fa-laptop-code',
                'administrator-system': 'fas fa-cogs',

                // PERBAIKAN 1: System Status sebagai menu terpisah
                'systemstatus': 'fas fa-server',

                // Others
                'profile': 'fas fa-user-circle',
                'intercomm': 'fas fa-comments',
                'workflow': 'fas fa-project-diagram',
                'quickview': 'fas fa-chart-bar',
                'help': 'fas fa-question-circle',
                'mydrive': 'fas fa-hdd',
                'shareddrive': 'fas fa-users',
                'mycalendar': 'fas fa-calendar-alt'
            };

            return icons[page] || 'fas fa-file';
        }

        // Load a new tab
        function loadTab(pageId, title, icon) {
            // Check if tab already exists
            const existingTab = document.querySelector(`[data-tab-id="${pageId}"]`);
            if (existingTab) {
                // Switch to existing tab
                const tabLink = existingTab.querySelector('.nav-link');
                const tab = new bootstrap.Tab(tabLink);
                tab.show();
                updateTabCount();
                return;
            }

            // Create tab navigation item
            const tabId = `tab-${pageId}`;
            const tabNavItem = document.createElement('li');
            tabNavItem.className = 'nav-item tab-item';
            tabNavItem.setAttribute('data-tab-id', pageId);

            tabNavItem.innerHTML = `
                <a class="nav-link" data-bs-toggle="tab" href="#${tabId}">
                    <i class="${icon} me-1"></i> ${title}
                    <button class="close-tab" onclick="closeTab('${pageId}', event)">&times;</button>
                </a>
            `;

            // Add to tabs list (after dashboard)
            const mainTabs = document.getElementById('mainTabs');
            mainTabs.appendChild(tabNavItem);

            // Create tab content pane
            const tabContent = document.querySelector('.tab-content');
            const tabPane = document.createElement('div');
            tabPane.className = 'tab-pane fade';
            tabPane.id = tabId;

            // Load content based on page
            if (pageId === 'profile') {
                tabPane.innerHTML = getProfileContent();
            } else if (pageId === 'intercomm') {
                tabPane.innerHTML = getIntercommContent();
            } else if (pageId === 'workflow') {
                tabPane.innerHTML = getWorkflowContent();
            } else if (pageId === 'mydrive') {
                tabPane.innerHTML = getMyDriveContent();
            } else if (pageId === 'shareddrive') {
                tabPane.innerHTML = getSharedDriveContent();
            } else if (pageId === 'mycalendar') {
                tabPane.innerHTML = getMyCalendarContent();
            } else if (pageId === 'quickview') {
                tabPane.innerHTML = getQuickviewContent();
            } else if (pageId === 'systemstatus') {
                tabPane.innerHTML = getSystemStatusContent();
            } else if (pageId.startsWith('mydesk-') || pageId.startsWith('controlcenter-') || 
                       pageId.startsWith('operational-') || pageId.startsWith('finance-') ||
                       pageId.startsWith('support-') || pageId.startsWith('crm-') ||
                       pageId.startsWith('rnd-') || pageId.startsWith('shareholders-') ||
                       pageId.startsWith('investors-') || pageId.startsWith('dataroom-') ||
                       pageId.startsWith('legaladvisor-') || pageId.startsWith('administrator-')) {
                tabPane.innerHTML = getSubmenuContent(pageId, title, icon);
            } else {
                tabPane.innerHTML = getDefaultContent(pageId, title, icon);
            }

            tabContent.appendChild(tabPane);

            // Activate the new tab
            const tab = new bootstrap.Tab(tabNavItem.querySelector('.nav-link'));
            tab.show();

            // Add to active tabs array
            activeTabs.push({
                id: pageId,
                title: title,
                icon: icon,
                element: tabNavItem
            });

            // Update tab count
            updateTabCount();

            // Initialize content if needed
            setTimeout(() => {
                if (pageId === 'profile') {
                    initProfileTabs();
                } else if (pageId === 'quickview') {
                    initQuickviewCharts();
                } else if (pageId === 'intercomm') {
                    initIntercommChat();
                } else if (pageId === 'systemstatus') {
                    initSystemStatusCharts();
                }
            }, 100);
        }

        // PERBAIKAN 1: Fungsi untuk konten System Status (seperti di simulation1.html)
        function getSystemStatusContent() {
            return `
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-server"></i> System Status Dashboard</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="system-status-card">
                                            <h4 class="text-white mb-4"><i class="fas fa-server"></i> System Health Dashboard</h4>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Overall System Status</strong>
                                                </div>
                                                <span class="badge bg-success">Healthy</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Web Server</strong>
                                                </div>
                                                <span class="badge bg-success">Running</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Database</strong>
                                                </div>
                                                <span class="badge bg-success">Optimal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-warning"></span>
                                                    <strong>Email Service</strong>
                                                </div>
                                                <span class="badge bg-warning">Degraded</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>File Storage</strong>
                                                </div>
                                                <span class="badge bg-success">Normal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>API Gateway</strong>
                                                </div>
                                                <span class="badge bg-success">Stable</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6><i class="fas fa-chart-pie"></i> Resource Usage</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>CPU Usage</span>
                                                        <span>42%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-info" style="width: 42%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Memory Usage</span>
                                                        <span>68%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-warning" style="width: 68%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Storage Usage</span>
                                                        <span>54%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-success" style="width: 54%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3 resource-usage">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Network Load</span>
                                                        <span>32%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-primary" style="width: 32%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row mt-4">
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6><i class="fas fa-chart-line"></i> Performance Metrics</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="chart-container">
                                                    <canvas id="performanceChart"></canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6><i class="fas fa-database"></i> Database Statistics</h6>
                                            </div>
                                            <div class="card-body">
                                                <table class="table">
                                                    <tr>
                                                        <th>Active Connections</th>
                                                        <td><span class="badge bg-success">24/100</span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Query Response Time</th>
                                                        <td><span class="badge bg-success">42ms avg</span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Cache Hit Rate</th>
                                                        <td><span class="badge bg-success">92%</span></td>
                                                    </tr>
                                                    <tr>
                                                        <th>Replication Lag</th>
                                                        <td><span class="badge bg-success">0.5s</span></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize System Status Charts
        function initSystemStatusCharts() {
            const performanceCtx = document.getElementById('performanceChart');
            if (performanceCtx) {
                if (charts.performance) charts.performance.destroy();

                charts.performance = new Chart(performanceCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                        datasets: [{
                            label: 'CPU Usage (%)',
                            data: [35, 42, 38, 45, 50, 48, 40],
                            borderColor: '#3498db',
                            tension: 0.4
                        }, {
                            label: 'Memory Usage (%)',
                            data: [60, 65, 62, 68, 70, 66, 63],
                            borderColor: '#e74c3c',
                            tension: 0.4
                        }, {
                            label: 'Network (MB/s)',
                            data: [25, 30, 28, 35, 40, 38, 32],
                            borderColor: '#2ecc71',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // Get Submenu Content with 4 tabs
        function getSubmenuContent(pageId, title, icon) {
            return `
                <div class="profile-tabs">
                    <ul class="nav nav-tabs mb-4" id="${pageId}Tab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="${pageId}-overview-tab" data-bs-toggle="tab" data-bs-target="#${pageId}-overview" type="button">
                                <i class="fas fa-eye me-2"></i> Overview
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="${pageId}-details-tab" data-bs-toggle="tab" data-bs-target="#${pageId}-details" type="button">
                                <i class="fas fa-info-circle me-2"></i> Details
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="${pageId}-reports-tab" data-bs-toggle="tab" data-bs-target="#${pageId}-reports" type="button">
                                <i class="fas fa-chart-bar me-2"></i> Reports
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="${pageId}-tasks-tab" data-bs-toggle="tab" data-bs-target="#${pageId}-tasks" type="button">
                                <i class="fas fa-tasks me-2"></i> Tasks
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="${pageId}TabContent">
                        <!-- Overview Tab -->
                        <div class="tab-pane fade show active" id="${pageId}-overview" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="${icon}"></i> ${title} - Overview</h5>
                                </div>
                                <div class="card-body">
                                    <p>This is the overview for ${title}. Here you can see a summary of activities, performance metrics, and key information.</p>
                                    <div class="row mt-4">
                                        <div class="col-md-4">
                                            <div class="card stats-card">
                                                <div class="card-body">
                                                    <i class="fas fa-chart-line text-primary"></i>
                                                    <h3>85%</h3>
                                                    <p>Performance</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card stats-card">
                                                <div class="card-body">
                                                    <i class="fas fa-tasks text-success"></i>
                                                    <h3>24</h3>
                                                    <p>Active Tasks</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card stats-card">
                                                <div class="card-body">
                                                    <i class="fas fa-users text-warning"></i>
                                                    <h3>12</h3>
                                                    <p>Team Members</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Details Tab -->
                        <div class="tab-pane fade" id="${pageId}-details" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-info-circle"></i> ${title} - Details</h5>
                                </div>
                                <div class="card-body">
                                    <p>Detailed information about ${title}. This section contains comprehensive data, configurations, and settings.</p>
                                    <div class="mt-4">
                                        <h6>Configuration Details</h6>
                                        <table class="table">
                                            <tr>
                                                <th>Status:</th>
                                                <td><span class="badge bg-success">Active</span></td>
                                            </tr>
                                            <tr>
                                                <th>Last Updated:</th>
                                                <td>October 15, 2023</td>
                                            </tr>
                                            <tr>
                                                <th>Manager:</th>
                                                <td>Department Head</td>
                                            </tr>
                                            <tr>
                                                <th>Team Size:</th>
                                                <td>12 Members</td>
                                            </tr>
                                            <tr>
                                                <th>Budget:</th>
                                                <td>$125,000</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Reports Tab -->
                        <div class="tab-pane fade" id="${pageId}-reports" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-chart-bar"></i> ${title} - Reports</h5>
                                </div>
                                <div class="card-body">
                                    <p>Analytical reports and performance metrics for ${title}.</p>
                                    <div class="chart-container mt-4">
                                        <canvas id="${pageId}ReportChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tasks Tab -->
                        <div class="tab-pane fade" id="${pageId}-tasks" role="tabpanel">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5><i class="fas fa-tasks"></i> ${title} - Tasks</h5>
                                    <button class="btn btn-sm btn-primary" onclick="openTaskModal()">
                                        <i class="fas fa-plus"></i> New Task
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Task</th>
                                                    <th>Assignee</th>
                                                    <th>Due Date</th>
                                                    <th>Status</th>
                                                    <th>Priority</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Complete monthly report</td>
                                                    <td>John Doe</td>
                                                    <td>Oct 25, 2023</td>
                                                    <td><span class="badge badge-status badge-in-progress">In Progress</span></td>
                                                    <td><span class="badge bg-warning">Medium</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Review project documentation</td>
                                                    <td>Jane Smith</td>
                                                    <td>Oct 30, 2023</td>
                                                    <td><span class="badge badge-status badge-pending">Pending</span></td>
                                                    <td><span class="badge bg-success">Low</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Update system configurations</td>
                                                    <td>Robert Johnson</td>
                                                    <td>Oct 20, 2023</td>
                                                    <td><span class="badge badge-status badge-completed">Completed</span></td>
                                                    <td><span class="badge bg-danger">High</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get Intercomm Content with Chat
        function getIntercommContent() {
            return `
                <div class="row">
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-comments"></i> InterComm Channels</h5>
                            </div>
                            <div class="card-body">
                                <ul class="nav nav-tabs" id="intercommTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="server-tab" data-bs-toggle="tab" data-bs-target="#server" type="button">
                                            <i class="fas fa-server me-1"></i> Server
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="channel-tab" data-bs-toggle="tab" data-bs-target="#channel" type="button">
                                            <i class="fas fa-hashtag me-1"></i> Channel
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="direct-tab" data-bs-toggle="tab" data-bs-target="#direct" type="button">
                                            <i class="fas fa-user-friends me-1"></i> Direct Message
                                        </button>
                                    </li>
                                </ul>
                                <div class="tab-content mt-3" id="intercommTabContent">
                                    <!-- Server Tab -->
                                    <div class="tab-pane fade show active" id="server" role="tabpanel">
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center active" onclick="switchToChat('general')">
                                                <i class="fas fa-server me-3 text-primary"></i>
                                                <div>
                                                    <div class="fw-bold">General Server</div>
                                                    <small class="text-muted">Company-wide discussions</small>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('development')">
                                                <i class="fas fa-code me-3 text-success"></i>
                                                <div>
                                                    <div class="fw-bold">Development</div>
                                                    <small class="text-muted">Technical team discussions</small>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('marketing')">
                                                <i class="fas fa-bullhorn me-3 text-warning"></i>
                                                <div>
                                                    <div class="fw-bold">Marketing</div>
                                                    <small class="text-muted">Marketing campaigns and strategies</small>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('operations')">
                                                <i class="fas fa-cogs me-3 text-info"></i>
                                                <div>
                                                    <div class="fw-bold">Operations</div>
                                                    <small class="text-muted">Operational discussions</small>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                    
                                    <!-- Channel Tab -->
                                    <div class="tab-pane fade" id="channel" role="tabpanel">
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('general-channel')">
                                                <i class="fas fa-hashtag me-3 text-secondary"></i>
                                                <div>
                                                    <div class="fw-bold">#general</div>
                                                    <small class="text-muted">General discussions</small>
                                                </div>
                                                <span class="badge bg-primary ms-auto">245</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('random-channel')">
                                                <i class="fas fa-hashtag me-3 text-secondary"></i>
                                                <div>
                                                    <div class="fw-bold">#random</div>
                                                    <small class="text-muted">Off-topic discussions</small>
                                                </div>
                                                <span class="badge bg-primary ms-auto">89</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('development-channel')">
                                                <i class="fas fa-hashtag me-3 text-secondary"></i>
                                                <div>
                                                    <div class="fw-bold">#development</div>
                                                    <small class="text-muted">Development discussions</small>
                                                </div>
                                                <span class="badge bg-primary ms-auto">156</span>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" onclick="switchToChat('marketing-channel')">
                                                <i class="fas fa-hashtag me-3 text-secondary"></i>
                                                <div>
                                                    <div class="fw-bold">#marketing</div>
                                                    <small class="text-muted">Marketing discussions</small>
                                                </div>
                                                <span class="badge bg-primary ms-auto">72</span>
                                            </a>
                                        </div>
                                    </div>
                                    
                                    <!-- Direct Message Tab -->
                                    <div class="tab-pane fade" id="direct" role="tabpanel">
                                        <div class="list-group">
                                            <a href="#" class="list-group-item list-group-item-action" onclick="switchToChat('john-doe')">
                                                <div class="d-flex align-items-center">
                                                    <img src="https://ui-avatars.com/api/?name=John+Doe&background=3498db&color=fff&size=40" class="rounded-circle me-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex justify-content-between">
                                                            <div class="fw-bold">John Doe</div>
                                                            <small class="text-muted">2 hours ago</small>
                                                        </div>
                                                        <small class="text-muted">Can you review the Q3 report?</small>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action" onclick="switchToChat('jane-smith')">
                                                <div class="d-flex align-items-center">
                                                    <img src="https://ui-avatars.com/api/?name=Jane+Smith&background=2ecc71&color=fff&size=40" class="rounded-circle me-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex justify-content-between">
                                                            <div class="fw-bold">Jane Smith</div>
                                                            <small class="text-muted">1 hour ago</small>
                                                        </div>
                                                        <small class="text-muted">Meeting scheduled for tomorrow</small>
                                                    </div>
                                                </div>
                                            </a>
                                            <a href="#" class="list-group-item list-group-item-action" onclick="switchToChat('robert-johnson')">
                                                <div class="d-flex align-items-center">
                                                    <img src="https://ui-avatars.com/api/?name=Robert+Johnson&background=e74c3c&color=fff&size=40" class="rounded-circle me-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex justify-content-between">
                                                            <div class="fw-bold">Robert Johnson</div>
                                                            <small class="text-success">Online</small>
                                                        </div>
                                                        <small class="text-muted">Server migration completed</small>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-8">
                        <div class="card chat-container">
                            <div class="chat-header">
                                <h5><i class="fas fa-comments"></i> General Chat</h5>
                                <small class="text-muted">Company-wide discussions</small>
                            </div>
                            <div class="chat-messages" id="chatMessages">
                                <div class="chat-message">
                                    <div class="message-bubble">
                                        <div class="message-sender">John Doe</div>
                                        <div>Hello everyone! The Q3 report is ready for review.</div>
                                        <div class="message-time">10:30 AM</div>
                                    </div>
                                </div>
                                <div class="chat-message">
                                    <div class="message-bubble">
                                        <div class="message-sender">Jane Smith</div>
                                        <div>Great! I'll take a look this afternoon.</div>
                                        <div class="message-time">10:32 AM</div>
                                    </div>
                                </div>
                                <div class="chat-message sent">
                                    <div class="message-bubble">
                                        <div class="message-sender">You</div>
                                        <div>Thanks John. Please send me the link when it's uploaded.</div>
                                        <div class="message-time">10:35 AM</div>
                                    </div>
                                </div>
                                <div class="chat-message">
                                    <div class="message-bubble">
                                        <div class="message-sender">Robert Johnson</div>
                                        <div>Don't forget about the system maintenance tonight at 2 AM.</div>
                                        <div class="message-time">10:40 AM</div>
                                    </div>
                                </div>
                            </div>
                            <div class="chat-input">
                                <input type="text" class="form-control" placeholder="Type your message..." id="chatInput">
                                <button class="btn btn-primary" id="sendMessageBtn">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get Workflow Content (Task Management)
        function getWorkflowContent() {
            return `
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-tasks"></i> Task Management</h5>
                        <button class="btn btn-sm btn-primary" onclick="openTaskModal()">
                            <i class="fas fa-plus"></i> New Task
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Assignee</th>
                                        <th>Deadline</th>
                                        <th>Priority</th>
                                        <th>Status</th>
                                        <th>Progress</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Q3 Financial Report</td>
                                        <td>John Doe</td>
                                        <td>Oct 20, 2023</td>
                                        <td><span class="badge bg-danger">High</span></td>
                                        <td><span class="badge badge-status badge-in-progress">In Progress</span></td>
                                        <td>
                                            <div class="progress" style="height: 8px;">
                                                <div class="progress-bar bg-success" style="width: 75%"></div>
                                            </div>
                                            <small>75%</small>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(1)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Website Redesign</td>
                                        <td>Jane Smith</td>
                                        <td>Oct 25, 2023</td>
                                        <td><span class="badge bg-warning">Medium</span></td>
                                        <td><span class="badge badge-status badge-pending">Pending</span></td>
                                        <td>
                                            <div class="progress" style="height: 8px;">
                                                <div class="progress-bar bg-warning" style="width: 0%"></div>
                                            </div>
                                            <small>0%</small>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(2)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Server Migration</td>
                                        <td>Robert Johnson</td>
                                        <td>Oct 18, 2023</td>
                                        <td><span class="badge bg-dark">Critical</span></td>
                                        <td><span class="badge badge-status badge-in-progress">In Progress</span></td>
                                        <td>
                                            <div class="progress" style="height: 8px;">
                                                <div class="progress-bar bg-info" style="width: 40%"></div>
                                            </div>
                                            <small>40%</small>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(3)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Marketing Campaign</td>
                                        <td>Sarah Williams</td>
                                        <td>Oct 30, 2023</td>
                                        <td><span class="badge bg-warning">Medium</span></td>
                                        <td><span class="badge badge-status badge-review">Review</span></td>
                                        <td>
                                            <div class="progress" style="height: 8px;">
                                                <div class="progress-bar bg-primary" style="width: 100%"></div>
                                            </div>
                                            <small>100%</small>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(4)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Employee Training</td>
                                        <td>Michael Brown</td>
                                        <td>Oct 22, 2023</td>
                                        <td><span class="badge bg-success">Low</span></td>
                                        <td><span class="badge badge-status badge-completed">Completed</span></td>
                                        <td>
                                            <div class="progress" style="height: 8px;">
                                                <div class="progress-bar bg-success" style="width: 100%"></div>
                                            </div>
                                            <small>100%</small>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary" onclick="editTask(5)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get My Drive Content
        function getMyDriveContent() {
            return `
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-hdd"></i> My Drive</h5>
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-upload"></i> Upload File
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-pdf text-danger"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Q3_Financial_Report.pdf</div>
                                <div class="file-meta">2.4 MB • Updated 2 days ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-excel text-success"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Budget_2024.xlsx</div>
                                <div class="file-meta">5.1 MB • Updated 1 week ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-word text-primary"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Project_Proposal.docx</div>
                                <div class="file-meta">1.8 MB • Updated 3 days ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-folder text-warning"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Meeting Notes</div>
                                <div class="file-meta">15 items • Updated 1 day ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-image text-info"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Company_Logo.png</div>
                                <div class="file-meta">850 KB • Updated 5 days ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get Shared Drive Content
        function getSharedDriveContent() {
            return `
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-users"></i> Shared Drive</h5>
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-plus"></i> New Folder
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-folder text-warning"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Company Policies</div>
                                <div class="file-meta">Shared by Admin • 25 items • Last updated: 2 days ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-folder text-warning"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Project Documents</div>
                                <div class="file-meta">Shared by Project Manager • 120 items • Last updated: 1 week ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-image text-info"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Company Logo Pack</div>
                                <div class="file-meta">15.2 MB • Shared by Marketing • Last updated: 3 days ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-video text-danger"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Training Videos</div>
                                <div class="file-meta">450 MB • Shared by HR • Last updated: 2 weeks ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        <div class="file-item">
                            <div class="file-icon">
                                <i class="fas fa-file-pdf text-danger"></i>
                            </div>
                            <div class="file-info">
                                <div class="file-name">Employee Handbook.pdf</div>
                                <div class="file-meta">3.2 MB • Shared by HR • Last updated: 1 month ago</div>
                            </div>
                            <div class="file-actions">
                                <button class="btn btn-sm btn-outline-secondary me-1">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-secondary">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get My Calendar Content
        function getMyCalendarContent() {
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);

            return `
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5><i class="fas fa-calendar-alt"></i> My Calendar</h5>
                                <div>
                                    <button class="btn btn-sm btn-outline-primary me-1">
                                        <i class="fas fa-plus"></i> Add Event
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-sync"></i> Refresh
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="calendar-event">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-users me-2 text-primary"></i>
                                                <strong>Board Meeting</strong>
                                            </div>
                                            <div class="text-muted mt-1">
                                                <i class="far fa-clock me-1"></i> 10:00 AM - 11:30 AM
                                            </div>
                                            <div class="text-muted">
                                                <i class="fas fa-map-marker-alt me-1"></i> Main Conference Room
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-primary">Meeting</span>
                                                <span class="badge bg-info ms-1">All Department Heads</span>
                                            </div>
                                        </div>
                                        <span class="badge bg-warning">Today</span>
                                    </div>
                                </div>
                                
                                <div class="calendar-event task">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-tasks me-2 text-success"></i>
                                                <strong>Submit Q3 Report</strong>
                                            </div>
                                            <div class="text-muted mt-1">
                                                <i class="far fa-clock me-1"></i> Deadline: 5:00 PM
                                            </div>
                                            <div class="text-muted">
                                                <i class="fas fa-user me-1"></i> Assigned to: John Doe
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-success">Task</span>
                                                <span class="badge bg-danger ms-1">High Priority</span>
                                            </div>
                                        </div>
                                        <span class="badge bg-warning">Today</span>
                                    </div>
                                </div>
                                
                                <div class="calendar-event">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-briefcase me-2 text-primary"></i>
                                                <strong>Client Presentation</strong>
                                            </div>
                                            <div class="text-muted mt-1">
                                                <i class="far fa-clock me-1"></i> 2:00 PM - 3:30 PM
                                            </div>
                                            <div class="text-muted">
                                                <i class="fas fa-map-marker-alt me-1"></i> Client Office
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-primary">Meeting</span>
                                                <span class="badge bg-warning ms-1">External</span>
                                            </div>
                                        </div>
                                        <span class="badge bg-info">Tomorrow</span>
                                    </div>
                                </div>
                                
                                <div class="calendar-event urgent">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-server me-2 text-danger"></i>
                                                <strong>Server Maintenance</strong>
                                            </div>
                                            <div class="text-muted mt-1">
                                                <i class="far fa-clock me-1"></i> 2:00 AM - 4:00 AM
                                            </div>
                                            <div class="text-muted">
                                                <i class="fas fa-map-marker-alt me-1"></i> Data Center
                                            </div>
                                            <div class="mt-2">
                                                <span class="badge bg-dark">Maintenance</span>
                                                <span class="badge bg-danger ms-1">Critical</span>
                                            </div>
                                        </div>
                                        <span class="badge bg-secondary">${tomorrow.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header">
                                <h6><i class="fas fa-calendar-check"></i> Upcoming Events</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <small class="text-muted">THIS WEEK</small>
                                    <div class="mt-2">
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="bg-primary text-white rounded p-1 me-2" style="width: 30px; text-align: center;">
                                                <small>MON</small>
                                            </div>
                                            <div>
                                                <small class="d-block">Team Standup</small>
                                                <small class="text-muted">9:00 AM</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="bg-primary text-white rounded p-1 me-2" style="width: 30px; text-align: center;">
                                                <small>WED</small>
                                            </div>
                                            <div>
                                                <small class="d-block">Project Review</small>
                                                <small class="text-muted">2:00 PM</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <small class="text-muted">NEXT WEEK</small>
                                    <div class="mt-2">
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="bg-info text-white rounded p-1 me-2" style="width: 30px; text-align: center;">
                                                <small>TUE</small>
                                            </div>
                                            <div>
                                                <small class="d-block">All Hands Meeting</small>
                                                <small class="text-muted">11:00 AM</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center mb-2">
                                            <div class="bg-info text-white rounded p-1 me-2" style="width: 30px; text-align: center;">
                                                <small>FRI</small>
                                            </div>
                                            <div>
                                                <small class="d-block">Q4 Planning</small>
                                                <small class="text-muted">10:00 AM</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get Quickview Content (Reports)
        function getQuickviewContent() {
            return `
                <div class="row">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-chart-bar"></i> Growth Aggregate</h5>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="quickviewGrowthChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-exchange-alt"></i> Exchange Rates</h5>
                            </div>
                            <div class="card-body">
                                <ul class="nav nav-tabs" id="quickviewExchangeTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="quickview-fiat-tab" data-bs-toggle="tab" data-bs-target="#quickview-fiat" type="button">Fiat</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="quickview-crypto-tab" data-bs-toggle="tab" data-bs-target="#quickview-crypto" type="button">Crypto</button>
                                    </li>
                                </ul>
                                <div class="tab-content mt-3" id="quickviewExchangeTabContent">
                                    <div class="tab-pane fade show active" id="quickview-fiat" role="tabpanel">
                                        <div class="chart-container">
                                            <canvas id="quickviewFiatChart"></canvas>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="quickview-crypto" role="tabpanel">
                                        <div class="chart-container">
                                            <canvas id="quickviewCryptoChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Status di QuickView tetap ada untuk konsistensi -->
                <div class="row mt-4">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-cogs"></i> System Status (Quick View)</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="system-status-card">
                                            <h4 class="text-white mb-4"><i class="fas fa-server"></i> System Health Dashboard</h4>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Overall System Status</strong>
                                                </div>
                                                <span class="badge bg-success">Healthy</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Web Server</strong>
                                                </div>
                                                <span class="badge bg-success">Running</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>Database</strong>
                                                </div>
                                                <span class="badge bg-success">Optimal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-warning"></span>
                                                    <strong>Email Service</strong>
                                                </div>
                                                <span class="badge bg-warning">Degraded</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>File Storage</strong>
                                                </div>
                                                <span class="badge bg-success">Normal</span>
                                            </div>
                                            <div class="system-status-item">
                                                <div>
                                                    <span class="status-indicator status-healthy"></span>
                                                    <strong>API Gateway</strong>
                                                </div>
                                                <span class="badge bg-success">Stable</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6><i class="fas fa-chart-pie"></i> Resource Usage</h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>CPU Usage</span>
                                                        <span>42%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-info" style="width: 42%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Memory Usage</span>
                                                        <span>68%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-warning" style="width: 68%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Storage Usage</span>
                                                        <span>54%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-success" style="width: 54%"></div>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>Network Load</span>
                                                        <span>32%</span>
                                                    </div>
                                                    <div class="progress" style="height: 10px;">
                                                        <div class="progress-bar bg-primary" style="width: 32%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get profile content with 4 tabs
        function getProfileContent() {
            return `
                <div class="profile-tabs">
                    <ul class="nav nav-tabs mb-4" id="profileTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="user-profile-tab" data-bs-toggle="tab" data-bs-target="#user-profile" type="button">
                                <i class="fas fa-user-circle me-2"></i> User Profile
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="user-setting-tab" data-bs-toggle="tab" data-bs-target="#user-setting" type="button">
                                <i class="fas fa-cogs me-2"></i> User Setting
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="bank-setting-tab" data-bs-toggle="tab" data-bs-target="#bank-setting" type="button">
                                <i class="fas fa-university me-2"></i> Bank Setting
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="user-log-tab" data-bs-toggle="tab" data-bs-target="#user-log" type="button">
                                <i class="fas fa-history me-2"></i> User Log
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="profileTabContent">
                        <!-- User Profile Tab -->
                        <div class="tab-pane fade show active" id="user-profile" role="tabpanel">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5><i class="fas fa-user-circle"></i> Profile Information</h5>
                                        </div>
                                        <div class="card-body text-center">
                                            <img id="profilePageImage" src="https://ui-avatars.com/api/?name=Admin+User&background=3498db&color=fff&size=256" 
                                                 class="img-fluid rounded-circle mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                                            <h4>Admin User</h4>
                                            <p class="text-muted">Administrator</p>
                                            <p><i class="fas fa-building"></i> Vencorio Inc.</p>
                                            <button class="btn btn-primary mt-2" data-bs-toggle="modal" data-bs-target="#profileModal">
                                                <i class="fas fa-edit"></i> Edit Profile
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="card mt-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-shield-alt"></i> Access Information</h5>
                                        </div>
                                        <div class="card-body">
                                            <table class="table table-borderless">
                                                <tr>
                                                    <th>WebApp Access:</th>
                                                    <td><span class="badge bg-success">Full Access</span></td>
                                                </tr>
                                                <tr>
                                                    <th>Role:</th>
                                                    <td>Administrator</td>
                                                </tr>
                                                <tr>
                                                    <th>Department:</th>
                                                    <td>Administration</td>
                                                </tr>
                                                <tr>
                                                    <th>Division:</th>
                                                    <td>IT Department</td>
                                                </tr>
                                                <tr>
                                                    <th>Employee ID:</th>
                                                    <td>26190101</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-lg-8">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5><i class="fas fa-info-circle"></i> User Details</h5>
                                        </div>
                                        <div class="card-body">
                                            <table class="table">
                                                <tr>
                                                    <th style="width: 30%;">Username:</th>
                                                    <td>admin</td>
                                                </tr>
                                                <tr>
                                                    <th>Email:</th>
                                                    <td>admin@vencorio.com</td>
                                                </tr>
                                                <tr>
                                                    <th>WhatsApp Number:</th>
                                                    <td>+62-81234567890</td>
                                                </tr>
                                                <tr>
                                                    <th>Company:</th>
                                                    <td>Vencorio Inc.</td>
                                                </tr>
                                                <tr>
                                                    <th>Department:</th>
                                                    <td>Administration</td>
                                                </tr>
                                                <tr>
                                                    <th>Division:</th>
                                                    <td>IT Department</td>
                                                </tr>
                                                <tr>
                                                    <th>Role:</th>
                                                    <td>Administrator</td>
                                                </tr>
                                                <tr>
                                                    <th>Account Created:</th>
                                                    <td>January 15, 2020</td>
                                                </tr>
                                                <tr>
                                                    <th>Last Login:</th>
                                                    <td>Today, 09:45 AM</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <div class="card mt-4">
                                        <div class="card-header">
                                            <h5><i class="fas fa-chart-line"></i> Activity Summary</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row text-center">
                                                <div class="col-md-3 mb-3">
                                                    <div class="border rounded p-3">
                                                        <h3 class="text-primary">156</h3>
                                                        <p class="mb-0">Tasks Completed</p>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="border rounded p-3">
                                                        <h3 class="text-success">42</h3>
                                                        <p class="mb-0">Projects Led</p>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="border rounded p-3">
                                                        <h3 class="text-warning">89</h3>
                                                        <p class="mb-0">Meetings Attended</p>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="border rounded p-3">
                                                        <h3 class="text-info">1,254</h3>
                                                        <p class="mb-0">Files Uploaded</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- User Setting Tab -->
                        <div class="tab-pane fade" id="user-setting" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-cogs"></i> User Settings</h5>
                                </div>
                                <div class="card-body">
                                    <form id="userSettingsForm">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h6 class="mb-3"><i class="fas fa-bell"></i> Notifications</h6>
                                                <div class="mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="userEmailNotifications" checked>
                                                        <label class="form-check-label" for="userEmailNotifications">Email Notifications</label>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="userPushNotifications" checked>
                                                        <label class="form-check-label" for="userPushNotifications">Push Notifications</label>
                                                    </div>
                                                </div>
                                                
                                                <h6 class="mb-3 mt-4"><i class="fas fa-language"></i> Language & Region</h6>
                                                <div class="mb-3">
                                                    <label for="userLanguageSelect" class="form-label">Language</label>
                                                    <select class="form-control" id="userLanguageSelect">
                                                        <option value="en">English</option>
                                                        <option value="id">Indonesian</option>
                                                    </select>
                                                </div>
                                                <div class="mb-3">
                                                    <label for="userTimezoneSelect" class="form-label">Timezone</label>
                                                    <select class="form-control" id="userTimezoneSelect">
                                                        <option value="Asia/Jakarta">Asia/Jakarta (WIB)</option>
                                                        <option value="UTC">UTC</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <h6 class="mb-3"><i class="fas fa-palette"></i> Appearance</h6>
                                                <div class="mb-3">
                                                    <label for="userThemeSelect" class="form-label">Theme</label>
                                                    <select class="form-control" id="userThemeSelect">
                                                        <option value="light">Light</option>
                                                        <option value="dark">Dark</option>
                                                        <option value="auto">Auto (System)</option>
                                                    </select>
                                                </div>
                                                
                                                <h6 class="mb-3 mt-4"><i class="fas fa-shield-alt"></i> Security</h6>
                                                <div class="mb-3">
                                                    <label class="form-label">Two-Factor Authentication</label>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="userTwoFactor" id="userTwoFactorOn" checked>
                                                        <label class="form-check-label" for="userTwoFactorOn">Enabled</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="radio" name="userTwoFactor" id="userTwoFactorOff">
                                                        <label class="form-check-label" for="userTwoFactorOff">Disabled</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-4">
                                            <button type="button" class="btn btn-primary" onclick="saveUserSettings()">
                                                <i class="fas fa-save"></i> Save Settings
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" onclick="resetUserSettings()">
                                                Reset to Default
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bank Setting Tab -->
                        <div class="tab-pane fade" id="bank-setting" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-university"></i> Bank Account Settings</h5>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i> Bank account information is securely encrypted and used for payroll and expense reimbursements.
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h6>Primary Bank Account</h6>
                                        <div class="card border-primary">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <p><strong>Bank Name:</strong> Bank Central Asia (BCA)</p>
                                                        <p><strong>Account Number:</strong> 123-456-7890</p>
                                                        <p><strong>Account Holder:</strong> Admin User</p>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <p><strong>Branch:</strong> Sudirman, Jakarta</p>
                                                        <p><strong>Currency:</strong> IDR</p>
                                                        <p><strong>Status:</strong> <span class="badge bg-success">Active</span></p>
                                                    </div>
                                                </div>
                                                <div class="mt-3">
                                                    <button class="btn btn-sm btn-outline-primary me-2">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger">Remove</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h6>Add New Bank Account</h6>
                                        <form>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Bank Name</label>
                                                    <input type="text" class="form-control" placeholder="Enter bank name">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Account Number</label>
                                                    <input type="text" class="form-control" placeholder="Enter account number">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Account Holder Name</label>
                                                    <input type="text" class="form-control" placeholder="Enter account holder name">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Branch</label>
                                                    <input type="text" class="form-control" placeholder="Enter branch location">
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-primary">Add Bank Account</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- User Log Tab -->
                        <div class="tab-pane fade" id="user-log" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-history"></i> Activity Log</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Timestamp</th>
                                                    <th>Activity</th>
                                                    <th>IP Address</th>
                                                    <th>Device</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>2023-10-15 09:45:23</td>
                                                    <td>Logged in to dashboard</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-success">Success</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-15 09:30:15</td>
                                                    <td>Updated task #1234</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-success">Success</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-15 09:15:42</td>
                                                    <td>Uploaded file: Q3_Report.pdf</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-success">Success</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-14 17:30:18</td>
                                                    <td>Sent announcement to team</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-success">Success</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-14 16:45:33</td>
                                                    <td>Approved expense report #5678</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-success">Success</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-14 15:20:11</td>
                                                    <td>Failed login attempt</td>
                                                    <td>203.0.113.5</td>
                                                    <td>Firefox on Linux</td>
                                                    <td><span class="badge bg-danger">Failed</span></td>
                                                </tr>
                                                <tr>
                                                    <td>2023-10-14 14:10:05</td>
                                                    <td>Logged out from system</td>
                                                    <td>192.168.1.100</td>
                                                    <td>Chrome on Windows</td>
                                                    <td><span class="badge bg-info">Info</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="mt-3">
                                        <button class="btn btn-outline-secondary">
                                            <i class="fas fa-download"></i> Export Logs
                                        </button>
                                        <button class="btn btn-outline-danger ms-2">
                                            <i class="fas fa-trash"></i> Clear Old Logs
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get default content for other tabs
        function getDefaultContent(pageId, title, icon) {
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h2><i class="${icon}"></i> ${title}</h2>
                        <p class="text-muted mb-0">Content for ${title}</p>
                    </div>
                    <div>
                        <button class="btn btn-primary">
                            <i class="fas fa-plus"></i> New
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <p>This is the ${title} page. Content would be loaded here in a real application.</p>
                        <p>Tab ID: ${pageId}</p>
                        <div class="mt-3">
                            <button class="btn btn-outline-primary" onclick="showToast('Action on ${title} page', 'info')">
                                <i class="fas fa-play"></i> Simulate Action
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize profile tabs
        function initProfileTabs() {
            const profileTab = new bootstrap.Tab(document.getElementById('user-profile-tab'));
            profileTab.show();
        }

        // Initialize intercomm chat
        function initIntercommChat() {
            const serverTab = new bootstrap.Tab(document.getElementById('server-tab'));
            serverTab.show();

            // Add event listener for send message button
            document.getElementById('sendMessageBtn')?.addEventListener('click', sendChatMessage);

            // Add event listener for enter key in chat input
            document.getElementById('chatInput')?.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
        }

        // Switch chat channel
        function switchToChat(channel) {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                const channelNames = {
                    'general': 'General Chat',
                    'development': 'Development Team',
                    'marketing': 'Marketing Team',
                    'operations': 'Operations Team',
                    'general-channel': '#general Channel',
                    'random-channel': '#random Channel',
                    'development-channel': '#development Channel',
                    'marketing-channel': '#marketing Channel',
                    'john-doe': 'John Doe',
                    'jane-smith': 'Jane Smith',
                    'robert-johnson': 'Robert Johnson'
                };

                const channelName = channelNames[channel] || channel;
                document.querySelector('.chat-header h5').innerHTML = `<i class="fas fa-comments"></i> ${channelName}`;

                // Update chat messages based on channel
                const messages = {
                    'general': [
                        {sender: 'John Doe', message: 'Hello everyone! The Q3 report is ready for review.', time: '10:30 AM', sent: false},
                        {sender: 'Jane Smith', message: 'Great! I\'ll take a look this afternoon.', time: '10:32 AM', sent: false},
                        {sender: 'You', message: 'Thanks John. Please send me the link when it\'s uploaded.', time: '10:35 AM', sent: true},
                        {sender: 'Robert Johnson', message: 'Don\'t forget about the system maintenance tonight at 2 AM.', time: '10:40 AM', sent: false}
                    ],
                    'development': [
                        {sender: 'Robert Johnson', message: 'The new API endpoints are now live.', time: '09:15 AM', sent: false},
                        {sender: 'You', message: 'Great work! Any issues with the deployment?', time: '09:20 AM', sent: true},
                        {sender: 'Robert Johnson', message: 'Everything went smoothly. Monitoring shows all systems green.', time: '09:22 AM', sent: false}
                    ],
                    'john-doe': [
                        {sender: 'John Doe', message: 'Can you review the Q3 report?', time: 'Yesterday', sent: false},
                        {sender: 'You', message: 'Sure, I\'ll review it this afternoon.', time: 'Yesterday', sent: true},
                        {sender: 'John Doe', message: 'Thanks! Let me know if you have any questions.', time: 'Today', sent: false}
                    ]
                };

                const channelMessages = messages[channel] || messages['general'];
                updateChatMessages(channelMessages);
            }
        }

        // Update chat messages
        function updateChatMessages(messages) {
            const chatMessages = document.getElementById('chatMessages');
            if (chatMessages) {
                chatMessages.innerHTML = '';

                messages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `chat-message ${msg.sent ? 'sent' : ''}`;
                    messageDiv.innerHTML = `
                        <div class="message-bubble">
                            <div class="message-sender">${msg.sender}</div>
                            <div>${msg.message}</div>
                            <div class="message-time">${msg.time}</div>
                        </div>
                    `;
                    chatMessages.appendChild(messageDiv);
                });

                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // Send chat message
        function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');

            if (chatInput && chatInput.value.trim() !== '' && chatMessages) {
                const message = chatInput.value.trim();
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');

                const messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message sent';
                messageDiv.innerHTML = `
                    <div class="message-bubble">
                        <div class="message-sender">You</div>
                        <div>${message}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
                chatMessages.appendChild(messageDiv);

                // Clear input
                chatInput.value = '';

                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;

                // Simulate reply after 1 second
                setTimeout(() => {
                    const replyDiv = document.createElement('div');
                    replyDiv.className = 'chat-message';
                    replyDiv.innerHTML = `
                        <div class="message-bubble">
                            <div class="message-sender">System</div>
                            <div>Message received and logged.</div>
                            <div class="message-time">${time}</div>
                        </div>
                    `;
                    chatMessages.appendChild(replyDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);
            }
        }

        // Initialize dashboard charts
        function initDashboardCharts() {
            // Workflow Chart
            const workflowCtx = document.getElementById('workflowChart');
            if (workflowCtx) {
                if (charts.workflow) charts.workflow.destroy();

                charts.workflow = new Chart(workflowCtx.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: ['Pending', 'In Progress', 'Review', 'Completed'],
                        datasets: [{
                            data: [12, 8, 5, 20],
                            backgroundColor: ['#ffc107', '#17a2b8', '#28a745', '#007bff'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Growth Chart
            const growthCtx = document.getElementById('growthChart');
            if (growthCtx) {
                if (charts.growth) charts.growth.destroy();

                charts.growth = new Chart(growthCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                        datasets: [{
                            label: 'Task Completion',
                            data: [65, 78, 66, 82, 75, 88, 92, 85, 90, 95],
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Fiat Chart
            const fiatCtx = document.getElementById('fiatChart');
            if (fiatCtx) {
                if (charts.fiat) charts.fiat.destroy();

                charts.fiat = new Chart(fiatCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['USD/IDR', 'EUR/IDR', 'JPY/IDR', 'SGD/IDR'],
                        datasets: [{
                            label: 'Exchange Rate',
                            data: [15500, 16800, 104, 11500],
                            backgroundColor: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Crypto Chart
            const cryptoCtx = document.getElementById('cryptoChart');
            if (cryptoCtx) {
                if (charts.crypto) charts.crypto.destroy();

                charts.crypto = new Chart(cryptoCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00'],
                        datasets: [
                            {
                                label: 'BTC/USD',
                                data: [41500, 41800, 42000, 42200, 41900, 42100, 42300],
                                borderColor: '#f39c12',
                                tension: 0.4
                            },
                            {
                                label: 'ETH/USD',
                                data: [2200, 2210, 2190, 2220, 2230, 2215, 2240],
                                borderColor: '#8e44ad',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false
                            }
                        }
                    }
                });
            }
        }

        // Initialize quickview charts
        function initQuickviewCharts() {
            // Growth Chart
            const growthCtx = document.getElementById('quickviewGrowthChart');
            if (growthCtx) {
                if (charts.quickviewGrowth) charts.quickviewGrowth.destroy();

                charts.quickviewGrowth = new Chart(growthCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                        datasets: [{
                            label: 'Task Completion',
                            data: [65, 78, 66, 82, 75, 88, 92, 85, 90, 95],
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Fiat Chart
            const fiatCtx = document.getElementById('quickviewFiatChart');
            if (fiatCtx) {
                if (charts.quickviewFiat) charts.quickviewFiat.destroy();

                charts.quickviewFiat = new Chart(fiatCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['USD/IDR', 'EUR/IDR', 'JPY/IDR', 'SGD/IDR'],
                        datasets: [{
                            label: 'Exchange Rate',
                            data: [15500, 16800, 104, 11500],
                            backgroundColor: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Crypto Chart
            const cryptoCtx = document.getElementById('quickviewCryptoChart');
            if (cryptoCtx) {
                if (charts.quickviewCrypto) charts.quickviewCrypto.destroy();

                charts.quickviewCrypto = new Chart(cryptoCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00'],
                        datasets: [
                            {
                                label: 'BTC/USD',
                                data: [41500, 41800, 42000, 42200, 41900, 42100, 42300],
                                borderColor: '#f39c12',
                                tension: 0.4
                            },
                            {
                                label: 'ETH/USD',
                                data: [2200, 2210, 2190, 2220, 2230, 2215, 2240],
                                borderColor: '#8e44ad',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false
                            }
                        }
                    }
                });
            }
        }

        // Close a tab
        function closeTab(tabId, event) {
            if (event) event.stopPropagation();

            if (tabId === 'dashboard') {
                showToast('Dashboard tab cannot be closed', 'warning');
                return;
            }

            const tabElement = document.querySelector(`[data-tab-id="${tabId}"]`);
            const tabPane = document.getElementById(`tab-${tabId}`);

            if (tabElement && tabPane) {
                // Remove from DOM
                tabElement.remove();
                tabPane.remove();

                // Remove from active tabs array
                activeTabs = activeTabs.filter(tab => tab.id !== tabId);

                // Update tab count
                updateTabCount();

                // Switch to dashboard if no other tabs
                if (!document.querySelector('.nav-link.active')) {
                    switchToDashboard();
                }
            }
        }

        // Update tab count display
        function updateTabCount() {
            // Update page title with tab count
            const tabCount = activeTabs.length + 1; // +1 for dashboard
            const currentTab = getCurrentTab();

            if (currentTab === 'dashboard') {
                document.getElementById('pageTitle').textContent = 'Admin Dashboard';
                document.getElementById('pageSubtitle').innerHTML = 'Welcome back, <span id="greetingName">Admin</span>. Here\'s what\'s happening today.';
            } else {
                document.getElementById('pageTitle').textContent = `Admin Dashboard (${tabCount} tabs)`;
            }
        }

        // Get current active tab
        function getCurrentTab() {
            const activeTab = document.querySelector('.nav-link.active');
            if (activeTab) {
                const href = activeTab.getAttribute('href');
                if (href === '#tab-dashboard') {
                    return 'dashboard';
                } else {
                    const tabItem = activeTab.closest('.tab-item');
                    if (tabItem) {
                        return tabItem.getAttribute('data-tab-id');
                    }
                }
            }
            return 'dashboard';
        }

        // Initialize event listeners
        function initEventListeners() {
            // Refresh data button
            document.getElementById('refreshDataBtn').addEventListener('click', refreshData);

            // Theme dropdown
            document.querySelectorAll('[data-theme]').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const theme = this.getAttribute('data-theme');
                    setTheme(theme);
                    localStorage.setItem('vencorio_theme', theme);
                });
            });

            // Notification dropdown
            const notificationDropdown = document.getElementById('notificationDropdown');
            const notificationBtn = notificationDropdown.querySelector('.notification-btn');

            notificationBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                notificationDropdown.classList.toggle('active');
            });

            document.addEventListener('click', function(e) {
                if (!notificationDropdown.contains(e.target)) {
                    notificationDropdown.classList.remove('active');
                }
            });

            // Mark all notifications as read
            document.getElementById('markAllRead').addEventListener('click', function(e) {
                e.preventDefault();
                showToast('All notifications marked as read', 'success');
            });

            // Quick actions
            document.querySelectorAll('[data-action]').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const action = this.getAttribute('data-action');
                    handleQuickAction(action);
                });
            });

            // Profile modal buttons
            document.getElementById('changePhotoBtn').addEventListener('click', function() {
                document.getElementById('photoUpload').click();
            });

            document.getElementById('photoUpload').addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        document.getElementById('modalProfileImage').src = event.target.result;
                        document.getElementById('profileImage').src = event.target.result;
                        showToast('Profile picture updated!', 'success');
                    };
                    reader.readAsDataURL(e.target.files[0]);
                }
            });

            document.getElementById('saveProfileBtn').addEventListener('click', function() {
                const modal = bootstrap.Modal.getInstance(document.getElementById('profileModal'));
                modal.hide();
                showToast('Profile updated successfully!', 'success');
            });

            // Settings modal
            document.getElementById('saveSettingsBtn').addEventListener('click', function() {
                const modal = bootstrap.Modal.getInstance(document.getElementById('settingsModal'));
                modal.hide();
                showToast('Settings saved successfully!', 'success');
            });

            // Tab manager
            document.getElementById('tabManagerBtn').addEventListener('click', function() {
                document.querySelector('.tab-manager').classList.toggle('active');
            });

            document.getElementById('closeAllTabs').addEventListener('click', closeAllTabs);
            document.getElementById('closeOtherTabs').addEventListener('click', closeOtherTabs);

            document.getElementById('reloadTab').addEventListener('click', function() {
                const currentTab = getCurrentTab();
                showToast(`Reloading ${currentTab} tab...`, 'info');
            });

            document.getElementById('pinTab').addEventListener('click', function() {
                showToast('Tab pinned', 'info');
            });

            // Close tab manager when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.tab-manager')) {
                    document.querySelector('.tab-manager').classList.remove('active');
                }
            });

            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', logout);
        }

        // Close all tabs except dashboard
        function closeAllTabs() {
            const tabsToClose = [...activeTabs].filter(tab => tab.id !== 'dashboard');

            tabsToClose.forEach(tab => {
                closeTab(tab.id);
            });

            showToast('All tabs closed', 'info');
        }

        // Close other tabs
        function closeOtherTabs() {
            const currentTab = getCurrentTab();
            if (!currentTab || currentTab === 'dashboard') return;

            const tabsToClose = activeTabs.filter(tab => tab.id !== 'dashboard' && tab.id !== currentTab);

            tabsToClose.forEach(tab => {
                closeTab(tab.id);
            });

            showToast('Other tabs closed', 'info');
        }

        // Handle quick actions
        function handleQuickAction(action) {
            switch(action) {
                case 'new-task':
                    openTaskModal();
                    break;
                case 'new-announcement':
                    showToast('New announcement created', 'success');
                    break;
                case 'upload-file':
                    showToast('File upload dialog opened', 'info');
                    break;
                case 'schedule-meeting':
                    showToast('Meeting scheduling dialog opened', 'info');
                    break;
            }
        }

        // Open task modal
        function openTaskModal() {
            const modal = new bootstrap.Modal(document.getElementById('taskModal'));
            modal.show();
        }

        // Edit task
        function editTask(taskId) {
            showToast(`Editing task #${taskId}`, 'info');
        }

        // Save user settings
        function saveUserSettings() {
            showToast('User settings saved successfully!', 'success');
        }

        // Reset user settings
        function resetUserSettings() {
            if (confirm('Are you sure you want to reset user settings to default?')) {
                showToast('User settings reset to default!', 'info');
            }
        }

        // Load user data
        function loadUserData() {
            currentUser = {
                id: 1,
                username: 'admin',
                name: 'Admin User',
                email: 'admin@vencorio.com',
                employee_id: '26190101',
                company: 'Vencorio Inc.',
                wa_number: '+62-81234567890',
                department: 'Administration',
                division: 'IT Department',
                role: 'Administrator',
                profile_picture: 'https://ui-avatars.com/api/?name=Admin+User&background=3498db&color=fff&size=128'
            };

            // Update UI
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = currentUser.role;
            document.getElementById('userCompany').textContent = currentUser.company;
            document.getElementById('employeeId').textContent = currentUser.employee_id;
            document.getElementById('greetingName').textContent = 'Admin';

            // Load notifications
            loadNotifications();
        }

        // Load notifications
        function loadNotifications() {
            notifications = [
                { id: 1, type: 'task_assigned', title: 'New Task Assigned', message: 'You have been assigned: Q3 Financial Report', is_read: false, created_at: new Date(Date.now() - 2*60*60*1000).toISOString() },
                { id: 2, type: 'announcement', title: 'New Announcement', message: 'Company-wide meeting scheduled for Friday', is_read: false, created_at: new Date(Date.now() - 5*60*60*1000).toISOString() },
                { id: 3, type: 'intercomm', title: 'New Message', message: 'John Doe sent you a message in #general', is_read: true, created_at: new Date(Date.now() - 10*60*60*1000).toISOString() },
                { id: 4, type: 'system', title: 'System Update', message: 'System maintenance scheduled for Sunday 2AM-4AM', is_read: true, created_at: new Date(Date.now() - 24*60*60*1000).toISOString() },
                { id: 5, type: 'calendar', title: 'Meeting Reminder', message: 'Board meeting starts in 30 minutes', is_read: false, created_at: new Date(Date.now() - 30*60*1000).toISOString() }
            ];

            updateNotificationUI();
        }

        // Update notification UI
        function updateNotificationUI() {
            const notificationList = document.getElementById('notificationList');
            const unreadCount = notifications.filter(n => !n.is_read).length;

            // Update badge
            document.getElementById('notificationCount').textContent = unreadCount;

            // Update list
            if (notificationList) {
                notificationList.innerHTML = '';

                // Show only latest 5 notifications
                const latestNotifications = [...notifications].sort((a, b) => new Date(b.created_at) - new Date(a.created_at)).slice(0, 5);

                latestNotifications.forEach(notification => {
                    const timeAgo = timeSince(new Date(notification.created_at));
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `notification-item ${!notification.is_read ? 'unread' : ''}`;
                    notificationItem.innerHTML = `
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-time">${timeAgo}</div>
                    `;
                    notificationList.appendChild(notificationItem);
                });
            }
        }

        // Set theme
        function setTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
            } else {
                document.body.classList.remove('dark-mode');
            }

            // Update theme dropdown
            document.querySelectorAll('[data-theme]').forEach(item => {
                item.parentElement.classList.remove('active');
                if (item.getAttribute('data-theme') === theme) {
                    item.parentElement.classList.add('active');
                }
            });
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            // Create toast container if it doesn't exist
            let toastContainer = document.getElementById('toastContainer');
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.id = 'toastContainer';
                toastContainer.className = 'toast-container';
                document.body.appendChild(toastContainer);
            }

            // Create toast
            const toastId = 'toast-' + Date.now();
            const typeClass = type === 'success' ? 'bg-success' : 
                             type === 'error' ? 'bg-danger' : 
                             type === 'warning' ? 'bg-warning' : 'bg-info';

            const toast = document.createElement('div');
            toast.id = toastId;
            toast.className = `toast align-items-center text-white ${typeClass} border-0`;
            toast.setAttribute('role', 'alert');
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">
                        ${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;

            toastContainer.appendChild(toast);

            // Initialize and show toast
            const bsToast = new bootstrap.Toast(toast, { delay: 3000 });
            bsToast.show();

            // Remove toast after it's hidden
            toast.addEventListener('hidden.bs.toast', function() {
                toast.remove();
            });
        }

        // Update IP location
        function updateIPLocation() {
            document.getElementById('ipAddress').textContent = '192.168.1.100';
            document.getElementById('location').textContent = 'Jakarta, Indonesia';
        }

        // Set greeting based on time of day
        function setGreeting() {
            const hour = new Date().getHours();
            let greeting = '';

            if (hour < 12) greeting = 'Good morning';
            else if (hour < 18) greeting = 'Good afternoon';
            else greeting = 'Good evening';

            const subtitle = document.getElementById('pageSubtitle');
            if (subtitle) {
                subtitle.innerHTML = `${greeting}, <span id="greetingName">Admin</span>. Here's what's happening today.`;
            }
        }

        // Calculate time since
        function timeSince(date) {
            const seconds = Math.floor((new Date() - date) / 1000);

            let interval = Math.floor(seconds / 31536000);
            if (interval >= 1) return interval + " year" + (interval > 1 ? "s" : "") + " ago";

            interval = Math.floor(seconds / 2592000);
            if (interval >= 1) return interval + " month" + (interval > 1 ? "s" : "") + " ago";

            interval = Math.floor(seconds / 86400);
            if (interval >= 1) return interval + " day" + (interval > 1 ? "s" : "") + " ago";

            interval = Math.floor(seconds / 3600);
            if (interval >= 1) return interval + " hour" + (interval > 1 ? "s" : "") + " ago";

            interval = Math.floor(seconds / 60);
            if (interval >= 1) return interval + " minute" + (interval > 1 ? "s" : "") + " ago";

            return Math.floor(seconds) + " second" + (seconds > 1 ? "s" : "") + " ago";
        }

        // Refresh data
        function refreshData() {
            showToast('Refreshing data...', 'info');
            // In a real app, this would reload data from server
            setTimeout(() => {
                showToast('Data refreshed successfully!', 'success');
            }, 1000);
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                showToast('Logout successful! Redirecting to login...', 'info');
                // In a real app, this would redirect to login page
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
            }
        }

        // Make functions available globally
        window.closeTab = closeTab;
        window.openTaskModal = openTaskModal;
        window.editTask = editTask;
        window.saveUserSettings = saveUserSettings;
        window.resetUserSettings = resetUserSettings;
        window.switchToChat = switchToChat;
        window.sendChatMessage = sendChatMessage;
    </script>
</body>
</html>